{"version":3,"sources":["../src/content.js"],"names":["define","$","Log","Ajax","Content","rootel","instanceid","self","prototype","main","on","e","preventDefault","button","approve","delete","post","closest","id","data","addClass","call","methodname","args","done","removeClass","fail","reason","error","debug","fadeOut","remove","init","first","length","content"],"mappings":"AAqBAA,OAAM,8BAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,WAAvB,CAAD,CAAsC,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAAuB,CAC/D,aAyBA,QAASC,CAAAA,CAAT,CAAiBC,CAAjB,CAAyBC,CAAzB,CAAqC,CACjC,GAAIC,CAAAA,CAAI,CAAG,IAAX,CACAA,CAAI,CAACF,MAAL,CAAcA,CAAd,CACAE,CAAI,CAACD,UAAL,CAAkBA,CACrB,CAMDF,CAAO,CAACI,SAAR,CAAkBC,IAAlB,CAAyB,UAAY,CACjC,GAAIF,CAAAA,CAAI,CAAG,IAAX,CAGAA,CAAI,CAACF,MAAL,CAAYK,EAAZ,CAAe,OAAf,CAAwB,uBAAxB,CAAiD,SAASC,CAAT,CAAY,CACzDA,CAAC,CAACC,cAAF,GACA,GAAIC,CAAAA,CAAM,CAAGZ,CAAC,CAAC,IAAD,CAAd,CACAM,CAAI,CAACO,OAAL,CAAaD,CAAb,CACH,CAJD,EAOAN,CAAI,CAACF,MAAL,CAAYK,EAAZ,CAAe,OAAf,CAAwB,sBAAxB,CAAgD,SAASC,CAAT,CAAY,CACxDA,CAAC,CAACC,cAAF,GACA,GAAIC,CAAAA,CAAM,CAAGZ,CAAC,CAAC,IAAD,CAAd,CACAM,CAAI,CAACQ,MAAL,CAAYF,CAAZ,CACH,CAJD,CAKH,CAhBD,CAuBAT,CAAO,CAACI,SAAR,CAAkBM,OAAlB,CAA4B,SAAUD,CAAV,CAAkB,IACtCN,CAAAA,CAAI,CAAG,IAD+B,CAGtCS,CAAI,CAAGH,CAAM,CAACI,OAAP,CAAe,OAAf,CAH+B,CAItCC,CAAE,CAAGF,CAAI,CAACG,IAAL,CAAU,IAAV,CAJiC,CAK1CH,CAAI,CAACI,QAAL,CAAc,YAAd,EAEAjB,CAAI,CAACkB,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,iCADL,CAEPC,IAAI,CAAE,CAAEL,EAAE,CAAEA,CAAN,CAFC,CAGPM,IAAI,CAAE,eAAmB,CACrBR,CAAI,CAACS,WAAL,CAAiB,YAAjB,EACAT,CAAI,CAACS,WAAL,CAAiB,YAAjB,CACH,CANM,CAOPC,IAAI,CAAE,cAASC,CAAT,CAAiB,CACnBX,CAAI,CAACS,WAAL,CAAiB,YAAjB,EACAvB,CAAG,CAAC0B,KAAJ,CAAU,wDAAV,EACA1B,CAAG,CAAC2B,KAAJ,CAAUF,CAAV,CACH,CAXM,CAAD,CAAV,CAaH,CApBD,CA4BAvB,CAAO,CAACI,SAAR,CAAkBO,MAAlB,CAA2B,SAAUF,CAAV,CAAkB,IACrCN,CAAAA,CAAI,CAAG,IAD8B,CAGrCS,CAAI,CAAGH,CAAM,CAACI,OAAP,CAAe,OAAf,CAH8B,CAIrCC,CAAE,CAAGF,CAAI,CAACG,IAAL,CAAU,IAAV,CAJgC,CAKzCH,CAAI,CAACI,QAAL,CAAc,YAAd,EAEAjB,CAAI,CAACkB,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,gCADL,CAEPC,IAAI,CAAE,CAAEL,EAAE,CAAEA,CAAN,CAFC,CAGPM,IAAI,CAAE,eAAmB,CACrBR,CAAI,CAACS,WAAL,CAAiB,YAAjB,EACAT,CAAI,CAACI,QAAL,CAAc,UAAd,EACAJ,CAAI,CAACc,OAAL,CAAa,GAAb,CAAmB,UAAW,CAC1Bd,CAAI,CAACe,MAAL,EACH,CAFD,CAGH,CATM,CAUPL,IAAI,CAAE,cAASC,CAAT,CAAiB,CACnBX,CAAI,CAACS,WAAL,CAAiB,YAAjB,EACAvB,CAAG,CAAC0B,KAAJ,CAAU,uDAAV,EACA1B,CAAG,CAAC2B,KAAJ,CAAUF,CAAV,CACH,CAdM,CAAD,CAAV,CAgBH,CAvBD,CA0BA,MAAO,CACHK,IAAI,CA5GR,SAAc1B,CAAd,CAA0B,CACtBJ,CAAG,CAAC2B,KAAJ,CAAU,0CAAV,EAEA,GAAIxB,CAAAA,CAAM,CAAGJ,CAAC,CAAC,8CAA+CK,CAA/C,CAA4D,KAA7D,CAAD,CAAoE2B,KAApE,EAAb,CAEA,GAAI,CAAC5B,CAAM,CAAC6B,MAAZ,CAAoB,CAChBhC,CAAG,CAAC0B,KAAJ,CAAU,wDAAV,EACA,MACH,CAED,GAAIO,CAAAA,CAAO,CAAG,GAAI/B,CAAAA,CAAJ,CAAYC,CAAZ,CAAoBC,CAApB,CAAd,CACA6B,CAAO,CAAC1B,IAAR,EACH,CA+FM,CAGV,CApHK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * @package   block_appreciation\r\n * @copyright 2020 Michael Vangelovski\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', 'core/log', 'core/ajax'], function($, Log, Ajax) {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * Initializes the component.\r\n     */\r\n    function init(instanceid) {\r\n        Log.debug('block_appreciation/content: initializing');\r\n\r\n        var rootel = $('[data-region=\"block_appreciation-instance-' + instanceid + '\"]').first();\r\n\r\n        if (!rootel.length) {\r\n            Log.error('block_appreciation/control: wrapping region not found!');\r\n            return;\r\n        }\r\n\r\n        var content = new Content(rootel, instanceid);\r\n        content.main();\r\n    }\r\n\r\n    /**\r\n     * The constructor\r\n     *\r\n     * @constructor\r\n     * @param {jQuery} rootel\r\n     */\r\n    function Content(rootel, instanceid) {\r\n        var self = this;\r\n        self.rootel = rootel;\r\n        self.instanceid = instanceid;\r\n    }\r\n\r\n    /**\r\n     * Run the Audience Selector.\r\n     *\r\n     */\r\n    Content.prototype.main = function () {\r\n        var self = this;\r\n\r\n        // Handle approve click.\r\n        self.rootel.on('click', '.post .action-approve', function(e) {\r\n            e.preventDefault();\r\n            var button = $(this);\r\n            self.approve(button);\r\n        });\r\n\r\n        // Handle delete click.\r\n        self.rootel.on('click', '.post .action-delete', function(e) {\r\n            e.preventDefault();\r\n            var button = $(this);\r\n            self.delete(button);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Approve a post.\r\n     *\r\n     * @method approve\r\n     */\r\n    Content.prototype.approve = function (button) {\r\n        var self = this;\r\n\r\n        var post = button.closest('.post');\r\n        var id = post.data('id');\r\n        post.addClass('submitting');\r\n      \r\n        Ajax.call([{\r\n            methodname: 'block_appreciation_approve_post',\r\n            args: { id: id },\r\n            done: function(response) {\r\n                post.removeClass('submitting');\r\n                post.removeClass('unapproved');\r\n            },\r\n            fail: function(reason) {\r\n                post.removeClass('submitting');\r\n                Log.error('block_appreciation/content: failed to approve the post');\r\n                Log.debug(reason);\r\n            }\r\n        }]);\r\n    };\r\n\r\n\r\n    /**\r\n     * Delete a post.\r\n     *\r\n     * @method delete\r\n     */\r\n    Content.prototype.delete = function (button) {\r\n        var self = this;\r\n\r\n        var post = button.closest('.post');\r\n        var id = post.data('id');\r\n        post.addClass('submitting');\r\n      \r\n        Ajax.call([{\r\n            methodname: 'block_appreciation_delete_post',\r\n            args: { id: id },\r\n            done: function(response) {\r\n                post.removeClass('submitting');\r\n                post.addClass('removing');\r\n                post.fadeOut(1000, function() {\r\n                    post.remove();\r\n                });\r\n            },\r\n            fail: function(reason) {\r\n                post.removeClass('submitting');\r\n                Log.error('block_appreciation/content: failed to delete the post');\r\n                Log.debug(reason);\r\n            }\r\n        }]);\r\n    };\r\n\r\n\r\n    return {\r\n        init: init\r\n    };\r\n});"],"file":"content.min.js"}