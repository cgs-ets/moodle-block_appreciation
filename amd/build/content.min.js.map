{"version":3,"sources":["../src/content.js"],"names":["define","$","Log","Ajax","Templates","Str","ModalFactory","Content","rootel","instanceid","self","component","modals","VIEWUSERS","templates","strings","get_strings","key","then","s","continueintersection","prototype","main","on","e","preventDefault","button","approve","delete","heart","hasClass","removeClass","unlike","toggleClass","addClass","like","getLikeUsers","preloads","loadModal","types","DEFAULT","loadTemplate","when","apply","InfiniteScroll","path","append","history","status","post","closest","id","data","call","methodname","args","done","fail","reason","error","debug","fadeOut","remove","getModal","setBody","show","response","Object","keys","length","setTitle","render","html","modalkey","title","buttontext","type","create","modal","setSaveButtonText","getBackdrop","getRoot","templatekey","init","first","content"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * @package   block_appreciation\r\n * @copyright 2020 Michael Vangelovski\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['jquery', 'core/log', 'core/ajax','core/templates', \r\n        'core/str', 'core/modal_factory', 'core/modal_events' ], \r\n        function($, Log, Ajax, Templates, Str, ModalFactory, ModalEvents) {    \r\n    'use strict';\r\n\r\n    /**\r\n     * Initializes the component.\r\n     */\r\n    function init(instanceid) {\r\n        Log.debug('block_appreciation/content: initializing');\r\n\r\n        var rootel = $('[data-region=\"block_appreciation-instance-' + instanceid + '\"]').first();\r\n\r\n        if (!rootel.length) {\r\n            Log.error('block_appreciation/control: wrapping region not found!');\r\n            return;\r\n        }\r\n\r\n        var content = new Content(rootel, instanceid);\r\n        content.main();\r\n    }\r\n\r\n    /**\r\n     * The constructor\r\n     *\r\n     * @constructor\r\n     * @param {jQuery} rootel\r\n     */\r\n    function Content(rootel, instanceid) {\r\n        var self = this;\r\n        self.rootel = rootel;\r\n        self.instanceid = instanceid;\r\n        self.component = 'block_appreciation';\r\n\r\n        self.modals = {\r\n            VIEWUSERS: null,\r\n        };\r\n        self.templates = {\r\n            VIEWUSERS: 'block_appreciation/post_like_users',\r\n        };\r\n\r\n        // Get some strings for future use.\r\n        self.strings = {}\r\n        Str.get_strings([\r\n            {key: 'list:likes', component: self.component},\r\n        ]).then(function(s) {\r\n            self.strings.continueintersection = s[0];\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Run the Audience Selector.\r\n     *\r\n     */\r\n    Content.prototype.main = function () {\r\n        var self = this;\r\n\r\n        // Handle approve click.\r\n        self.rootel.on('click', '.post .action-approve', function(e) {\r\n            e.preventDefault();\r\n            var button = $(this);\r\n            self.approve(button);\r\n        });\r\n\r\n        // Handle delete click.\r\n        self.rootel.on('click', '.post .action-delete', function(e) {\r\n            e.preventDefault();\r\n            var button = $(this);\r\n            self.delete(button);\r\n        });\r\n\r\n\r\n        self.rootel.on('click touchstart', '.heart', function() {\r\n            var heart = $(this);\r\n\r\n            if (heart.hasClass('is_animating')) {\r\n                return;\r\n            }\r\n\r\n            if (heart.hasClass('is_selected')) {\r\n                heart.removeClass('is_selected');\r\n                // Delete the like.\r\n                self.unlike(heart);\r\n\r\n            } else {\r\n                heart.toggleClass('is_animating');\r\n            }\r\n        });\r\n\r\n        self.rootel.on('animationend', '.heart', function() {\r\n            var heart = $(this);\r\n            heart.toggleClass('is_animating');\r\n            if (!heart.hasClass('is_selected')) {\r\n                heart.addClass('is_selected');\r\n                // Insert the like.\r\n                self.like(heart);\r\n            }\r\n        });\r\n\r\n        // Handle get like users click.\r\n        self.rootel.on('click', '.post .action-getlikeusers', function(e) {\r\n            e.preventDefault();\r\n            var button = $(this);\r\n            self.getLikeUsers(button);\r\n        });\r\n\r\n        // Preload the modals and templates.\r\n        var preloads = [];\r\n        preloads.push(self.loadModal('VIEWUSERS', 'Post like users', '', ModalFactory.types.DEFAULT));\r\n        preloads.push(self.loadTemplate('VIEWUSERS'));\r\n        $.when.apply($, preloads).then(function() {\r\n            self.rootel.addClass('preloads-completed');\r\n        })\r\n\r\n        // set up infinite scroll\r\n        if(typeof InfiniteScroll != 'undefined') {\r\n          var infScroll = new InfiniteScroll( '.bapp-list', {\r\n            // options\r\n            path: '.next',\r\n            append: '.post',\r\n            history: false,\r\n            status: '.page-load-status',\r\n          });\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * Approve a post.\r\n     *\r\n     * @method approve\r\n     */\r\n    Content.prototype.approve = function (button) {\r\n        var self = this;\r\n\r\n        var post = button.closest('.post');\r\n        var id = post.data('id');\r\n        post.addClass('submitting');\r\n      \r\n        Ajax.call([{\r\n            methodname: 'block_appreciation_approve_post',\r\n            args: { id: id },\r\n            done: function(response) {\r\n                post.removeClass('submitting');\r\n                post.removeClass('unapproved');\r\n            },\r\n            fail: function(reason) {\r\n                post.removeClass('submitting');\r\n                Log.error('block_appreciation/content: failed to approve the post');\r\n                Log.debug(reason);\r\n            }\r\n        }]);\r\n    };\r\n\r\n\r\n    /**\r\n     * Delete a post.\r\n     *\r\n     * @method delete\r\n     */\r\n    Content.prototype.delete = function (button) {\r\n        var self = this;\r\n\r\n        var post = button.closest('.post');\r\n        var id = post.data('id');\r\n        post.addClass('submitting');\r\n      \r\n        Ajax.call([{\r\n            methodname: 'block_appreciation_delete_post',\r\n            args: { id: id },\r\n            done: function(response) {\r\n                post.removeClass('submitting');\r\n                post.addClass('removing');\r\n                post.fadeOut(1000, function() {\r\n                    post.remove();\r\n                });\r\n            },\r\n            fail: function(reason) {\r\n                post.removeClass('submitting');\r\n                Log.error('block_appreciation/content: failed to delete the post');\r\n                Log.debug(reason);\r\n            }\r\n        }]);\r\n    };\r\n\r\n    /**\r\n     * Like a post.\r\n     *\r\n     * @method approve\r\n     */\r\n    Content.prototype.like = function (heart) {\r\n        var self = this;\r\n\r\n        var post = heart.closest('.post');\r\n        var id = post.data('id');\r\n      \r\n        Ajax.call([{\r\n            methodname: 'block_appreciation_like_post',\r\n            args: { id: id },\r\n            done: function(response) {\r\n                Log.debug('block_appreciation/content: Like successful.');\r\n            },\r\n            fail: function(reason) {\r\n                Log.error('block_appreciation/content: Failed to like the post');\r\n                Log.debug(reason);\r\n            }\r\n        }]);\r\n    };\r\n\r\n\r\n    /**\r\n     * Unlike a post.\r\n     *\r\n     * @method approve\r\n     */\r\n    Content.prototype.unlike = function (heart) {\r\n        var self = this;\r\n\r\n        var post = heart.closest('.post');\r\n        var id = post.data('id');\r\n      \r\n        Ajax.call([{\r\n            methodname: 'block_appreciation_unlike_post',\r\n            args: { id: id },\r\n            done: function(response) {\r\n                Log.debug('block_appreciation/content: Unlike successful.');\r\n            },\r\n            fail: function(reason) {\r\n                Log.error('block_appreciation/content: Failed to unlike the post');\r\n                Log.debug(reason);\r\n            }\r\n        }]);\r\n    };\r\n\r\n    /**\r\n     * View a list of users that have liked a post.\r\n     *\r\n     * @method\r\n     */\r\n    Content.prototype.getLikeUsers = function (button) {\r\n        var self = this;\r\n\r\n        var post = button.closest('.post');\r\n        var id = post.data('id');\r\n\r\n        if (self.modals.VIEWUSERS) {\r\n            self.modals.VIEWUSERS.getModal().addClass('modal-xl');\r\n            self.modals.VIEWUSERS.setBody('<div style=\"font-style:italic;\">... Fetching user list ...<div class=\"loader\" style=\"display:block;\"><div class=\"circle spin\"></div></div></div>');\r\n            self.modals.VIEWUSERS.show();\r\n            Ajax.call([{\r\n                methodname: 'block_appreciation_get_like_users',\r\n                args: { id: id },\r\n                done: function(response) {\r\n                    var count = Object.keys(response['userslist']).length;\r\n                    self.modals.VIEWUSERS.setTitle('Likes');\r\n                    Templates.render(self.templates.VIEWUSERS, response)\r\n                        .done(function(html) {\r\n                            self.modals.VIEWUSERS.setBody(html);\r\n                        })\r\n                        .fail(function(reason) {\r\n                            Log.debug(reason);\r\n                            return \"Failed to render post like users.\"\r\n                        });\r\n                },\r\n                fail: function(reason) {\r\n                    Log.error('block_appreciation/list: unable to get post like users.');\r\n                    Log.debug(reason);\r\n                }\r\n            }]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Helper used to preload a modal\r\n     *\r\n     * @method loadModal\r\n     * @param {string} modalkey The property of the global modals variable\r\n     * @param {string} title The title of the modal\r\n     * @param {string} title The button text of the modal\r\n     * @return {object} jQuery promise\r\n     */\r\n    Content.prototype.loadModal = function (modalkey, title, buttontext, type) {\r\n        var self = this;\r\n        return ModalFactory.create({type: type}).then(function(modal) {\r\n            modal.setTitle(title);\r\n            if (buttontext) {\r\n                modal.setSaveButtonText(buttontext);\r\n            }\r\n            self.modals[modalkey] = modal;\r\n            // Preload backgrop.\r\n            modal.getBackdrop();\r\n            modal.getRoot().addClass('modal-' + modalkey);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Helper used to preload a template\r\n     *\r\n     * @method loadModal\r\n     * @param {string} templatekey The property of the global templates variable\r\n     * @return {object} jQuery promise\r\n     */\r\n    Content.prototype.loadTemplate = function (templatekey) {\r\n        var self = this;\r\n        return Templates.render(self.templates[templatekey], {});\r\n    }\r\n\r\n\r\n    return {\r\n        init: init\r\n    };\r\n});"],"file":"content.min.js"}